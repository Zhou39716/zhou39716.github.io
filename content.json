{"meta":{"title":"ben","subtitle":"ben","description":"blog for me","author":"ben","url":"http://zhou39716.github.io","root":"/"},"pages":[{"title":"404","date":"2021-05-10T04:48:55.000Z","updated":"2021-05-10T05:05:20.948Z","comments":true,"path":"404/index.html","permalink":"http://zhou39716.github.io/404/index.html","excerpt":"","text":""},{"title":"contact","date":"2021-05-10T04:48:47.000Z","updated":"2021-05-10T05:04:46.247Z","comments":true,"path":"contact/index.html","permalink":"http://zhou39716.github.io/contact/index.html","excerpt":"","text":""},{"title":"分类","date":"2021-05-10T04:48:43.000Z","updated":"2021-05-10T08:17:23.615Z","comments":true,"path":"categories/index.html","permalink":"http://zhou39716.github.io/categories/index.html","excerpt":"","text":""},{"title":"friends","date":"2021-05-10T04:48:49.000Z","updated":"2021-05-10T05:05:03.871Z","comments":true,"path":"friends/index.html","permalink":"http://zhou39716.github.io/friends/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-01-23T09:14:51.000Z","updated":"2021-05-10T08:43:11.587Z","comments":true,"path":"tags/index.html","permalink":"http://zhou39716.github.io/tags/index.html","excerpt":"","text":""},{"title":"about","date":"2021-05-10T04:48:46.000Z","updated":"2021-05-10T05:04:28.798Z","comments":true,"path":"about/index.html","permalink":"http://zhou39716.github.io/about/index.html","excerpt":"","text":""}],"posts":[{"title":"华为NAT","slug":"华为NAT","date":"2021-05-10T05:21:24.000Z","updated":"2021-05-10T09:51:08.528Z","comments":true,"path":"华为NAT/","link":"","permalink":"http://zhou39716.github.io/%E5%8D%8E%E4%B8%BANAT/","excerpt":"","text":"华为NAT","categories":[{"name":"网络","slug":"网络","permalink":"http://zhou39716.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"network","slug":"network","permalink":"http://zhou39716.github.io/tags/network/"},{"name":"pc","slug":"pc","permalink":"http://zhou39716.github.io/tags/pc/"}],"author":"ben"},{"title":"常用命令","slug":"常用命令","date":"2021-05-10T05:21:24.000Z","updated":"2021-05-10T09:50:49.588Z","comments":true,"path":"常用命令/","link":"","permalink":"http://zhou39716.github.io/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","excerpt":"","text":"常用命令ftp上传下载配置ftp ftp服务器地址 输入用户名 密码 bin &#x2F;&#x2F;bin模式 put 文件名 &#x2F;&#x2F;上传文件到ftp服务器 get 文件名 &#x2F;&#x2F;从ftp服务器下载文件 startup saved-configuration flash:&#x2F;文件名 &#x2F;&#x2F;下次启动加载的配置文件 三层交换先创建vlan vlan batch 20 30 40 将接口设置类型trunk\\acess int g0&#x2F;0&#x2F;1 port link type trunk port trunk allow pass vlan 20 30 40 &#x2F;&#x2F;trunk接口允许通过那些vlan int g0&#x2F;0&#x2F;2 port link type acess port defult vlan 40 &#x2F;&#x2F;acess接口属于哪个vlan int g0&#x2F;0&#x2F;3 vlanif 20 &#x2F;&#x2F;配置vlani接口ip vlanif接口id与vlan id 一致 ip address 10.10.10.99 24 &#x2F;&#x2F; 外网 vlanif 30 ip address 30.30.30.55 24 &#x2F;&#x2F;专网 vlan if 40 ip address 40.40.40.1 24 &#x2F;&#x2F;内网 ip route-static 11.11.11.0 24 30.30.30.55 &#x2F;&#x2F;访问专网路线的走vlan if 30 ip route-static 0.0.0.0 0.0.0.0 10.10.10.99 &#x2F;&#x2F;默认路由走外网 vlan if 20 dis ip routing-table &#x2F;&#x2F;查看路由表 防火墙常用配置先配置入方向和出方向接口的ip fire zone trust &#x2F;&#x2F;配置安全区域（内网） add int g0&#x2F;0&#x2F;1 fire zone untrust &#x2F;&#x2F;配置非安全区域（外网） add int g0&#x2F;0&#x2F;3 security-policy &#x2F;&#x2F;配置安全策略trust-untrust rule name outside source zone trust destination zone untrust action permit &#x2F;&#x2F;放行 最后注意是否有回程路由， 查看会话表 ip route-static 内网ip段 下一跳入方向的对端Ip","categories":[{"name":"网络","slug":"网络","permalink":"http://zhou39716.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"network","slug":"network","permalink":"http://zhou39716.github.io/tags/network/"}],"author":"ben"},{"title":"华为交换机基本配置命令详解","slug":"华为交换机基本配置命令详解","date":"2021-05-10T05:21:24.000Z","updated":"2021-05-10T09:51:25.667Z","comments":true,"path":"华为交换机基本配置命令详解/","link":"","permalink":"http://zhou39716.github.io/%E5%8D%8E%E4%B8%BA%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/","excerpt":"","text":"华为交换机基本配置命令详解1、配置文件相关命令[Quidway]display current-configuration 显示当前生效的配置 [Quidway]display saved-configuration显示flash中配置文件，即下次上电启动时所用的配置文件 reset saved-configuration 檫除旧的配置文件 reboot 交换机重启 display version 显示系统版本信息 2、基本配置[Quidway]super password修改特权用户密码 [Quidway]sysname 交换机命名 [Quidway]interface ethernet1&#x2F;0&#x2F;1进入接口视图 [Quidway]interface vlan1 进入接口视图 [Quidway-Vlan-interfacex]ip address10.1.1.11255.255.0.0配置VLAN的IP地址 [Quidway]ip route-static 0.0.0.0 0.0.0.010.1.1.1 静态路由＝网关 3、telnet配置[Quidway]user-interface vty 0 4 进入虚拟终端 [S3026-ui-vty0-4]authentication-mode password 设置口令模式 [S3026-ui-vty0-4]set authentication-mode password simplexmws123 设置口令 [S3026-ui-vty0-4]user privilege level 3 用户级别 4、端口配置[Quidway-Ethernet1&#x2F;0&#x2F;1]duplex &#123;half|full|auto&#125; 配置端口工作状态 [Quidway-Ethernet1&#x2F;0&#x2F;1]speed &#123;10|100|auto&#125; 配置端口工作速率 [Quidway-Ethernet1&#x2F;0&#x2F;1]flow-control 配置端口流控 [Quidway-Ethernet1&#x2F;0&#x2F;1]mdi &#123;across|auto|normal&#125; 配置端口平接扭接 [Quidway-Ethernet1&#x2F;0&#x2F;1]port link-type &#123;trunk|access|hybrid&#125;设置端口工作模式 [Quidway-Ethernet1&#x2F;0&#x2F;1]undo shutdown激活端口 [Quidway-Ethernet1&#x2F;0&#x2F;2]quit 退出系统视图 5、链路聚合配置[DeviceA] link-aggregation group 1 mode manual 创建手工聚合组1 [Qw_A] interface ethernet 1&#x2F;0&#x2F;1将以太网端口Ethernet1&#x2F;0&#x2F;1加入聚合组1 [Qw_A-Ethernet1&#x2F;0&#x2F;1] port link-aggregation group 1 [Qw_A-Ethernet1&#x2F;0&#x2F;1] interface ethernet 1&#x2F;0&#x2F;2将以太网端口Ethernet1&#x2F;0&#x2F;1加入聚合组1 [Qw_A-Ethernet1&#x2F;0&#x2F;2] port link-aggregation group 1 [Qw_A] link-aggregation group 1 service-type tunnel #在手工聚合组的基础上创建tunnel业务环回组。 [Qw_A] interface ethernet 1&#x2F;0&#x2F;1将以太网端口Ethernet1&#x2F;0&#x2F;1加入业务环回组。 [Qw_A-Ethernet1&#x2F;0&#x2F;1] undo stp [Qw_A-Ethernet1&#x2F;0&#x2F;1] port link-aggregation group 1 6、端口镜像[Quidway]monitor-port 指定镜像端口 [Quidway]port mirror 指定被镜像端口 [Quidway]port mirror int_list observing-port int_type int_num 指定镜像和被镜像 7、VLAN配置[Quidway]vlan4 创建VLAN [Quidway-vlan4]port ethernet1&#x2F;0&#x2F;1 to ethernet1&#x2F;0&#x2F;4 在VLAN中增加端口 ① 配置基于access的VLAN[Quidway-Ethernet1&#x2F;0&#x2F;2]port access vlan4 当前端口加入到VLAN 注意：缺省情况下，端口的链路类型为Access类型，所有Access端口均属于且只属于VLAN1 ② 配置基于trunk的VLAN[Quidway-Ethernet1&#x2F;0&#x2F;24]port link-type trunk设置当前端口为trunk [Quidway-Ethernet1&#x2F;0&#x2F;24]port trunk permit vlan &#123;ID|All&#125;设trunk允许的VLAN 注意：所有端口缺省情况下都是允许VLAN1的报文通过的 [Quidway-Ethernet1&#x2F;0&#x2F;2]port trunk pvid vlan 34 设置trunk端口的PVID ③ 配置基于Hybrid端口的VLAN[Quidway-Ethernet1&#x2F;0&#x2F;2]port link-type hybrid配置端口的链路类型为Hybrid类型 [Quidway-Ethernet1&#x2F;0&#x2F;2]port hybrid vlan vlan-id-list &#123; tagged | untagged &#125;允许指定的VLAN通过当前Hybrid端口 注意：缺省情况下，所有Hybrid端口只允许VLAN1通过 [Quidway-Ethernet1&#x2F;0&#x2F;2]port hybrid pvid vlan vlan-id设置Hybrid端口的缺省VLAN 注意：缺省情况下，Hybrid端口的缺省VLAN为VLAN1 ④ VLAN描述[Quidway]description string 指定VLAN描述字符 [Quidway]undodescription 删除VLAN描述字符 [Quidway]display vlan [vlan_id] 查看VLAN设置 ⑤ 私有VLAN配置[Qw_A-vlanx]isolate-user-vlan enable 设置主vlan [Qw_A]Isolate-user-vlan secondary 设置主vlan包括的子vlan [Quidway-Ethernet1&#x2F;0&#x2F;2]port hybrid pvid vlan 设置vlan的pvid [Quidway-Ethernet1&#x2F;0&#x2F;2]port hybrid pvid 删除vlan的pvid [Quidway-Ethernet1&#x2F;0&#x2F;2]port hybrid vlan vlan_id_list untagged 设置无标识的vlan 如果包的vlan id与PVId一致，则去掉vlan信息.默认PVID&#x3D;1。 所以设置PVID为所属vlan id,设置可以互通的vlan为untagged. 8、STP配置[Quidway]stp &#123;enable|disable&#125;设置生成树,默认关闭 [Quidway]stpmode rstp设置生成树模式为rstp [Quidway]stp priority8192 设置交换机的优先级 [Quidway]stp root &#123;primary|secondary&#125; 设置为根或根的备份 [Quidway-Ethernet0&#x2F;1]stp cost 200 设置交换机端口的花费 MSTP配置： #配置MST域名为info，MSTP修订级别为1，VLAN映射关系为VLAN2～VLAN10映射到生成树实例1上，VLAN20～VLAN30映射生成树实例2上。 system-view [Sysname] stp region-configuration [Sysname-mst-region] region-name info [Sysname-mst-region] instance 1 vlan 2 to 10 [Sysname-mst-region] instance 2 vlan 20 to 30 [Sysname-mst-region] revision-level 1 [Sysname-mst-region] active region-configuration 9、MAC地址表的操作① 在系统视图下添加MAC地址表项[Quidway]mac-address &#123; static | dynamic | blackhole &#125; mac-address interface interface-type interface-number vlan vlan-id；添加MAC地址表项 在添加MAC地址表项时，命令中interface参数指定的端口必须属于vlan参数指定的VLAN，否则将添加失败。 如果vlan参数指定的VLAN是动态VLAN，在添加静态MAC地址之后，会自动变为静态VLAN。 ② 在以太网端口视图下添加MAC地址表项[Quidway-Ethernet1&#x2F;0&#x2F;2]mac-address &#123; static | dynamic | blackhole &#125; mac-address vlan vlan-id 在添加MAC地址表项时，当前的端口必须属于命令中vlan参数指定的VLAN，否则将添加失败； 如果vlan参数指定的VLAN是动态VLAN，在添加静态MAC地址之后，会自动变为静态VLAN。 [Quidway]mac-address timer &#123; aging age | no-aging &#125;设置MAC地址表项的老化时间 注意：缺省情况下，MAC地址表项的老化时间为300秒，使用参数no-aging时表示不对MAC地址表项进行老化。 ③ MAC地址老化时间的配置对所有端口都生效，但地址老化功能只对动态的（学习到的或者用户配置可老化的）MAC地址表项起作用。[Quidway-Ethernet1&#x2F;0&#x2F;2]mac-address max-mac-count count设置端口最多可以学习到的MAC地址数量； 注意：缺省情况下，没有配置对端口学习MAC地址数量的限制。反之，如果端口启动了MAC地址认证和端口安全功能，则不能配置该端口的最大MAC地址学习个数。 [Quidway-Ethernet1&#x2F;0&#x2F;2]port-mac start-mac-address配置以太网端口MAC地址的起始值 在缺省情况下，E126&#x2F;E126A交换机的以太网端口是没有配置MAC地址的，因此当交换机在发送二层协议报文（例如STP）时，由于无法取用发送端口的MAC地址，将使用该协议预置的MAC地址作为源地址填充到报文中进行发送。在实际组网中，由于多台设备都使用相同的源MAC地址发送二层协议报文，会造成在某台设备的不同端口学习到相同MAC地址的情况，可能会对MAC地址表的维护产生影响。 [Quidway]display mac-address 显示地址表信息 [Quidway]display mac-address aging-time 显示地址表动态表项的老化时间 [Quidway]display port-mac 显示用户配置的以太网端口MAC地址的起始值 10、GVRP配置[Qw_A] gvrp 开启全局GVRP [Qw_A-Ethernet1&#x2F;0&#x2F;1] gvrp 在以太网端口Ethernet1&#x2F;0&#x2F;1上开启GVRP [Qw_A-Ethernet1&#x2F;0&#x2F;1] gvrp registration &#123; fixed | forbidden | normal &#125; 配置GVRP端口注册模式 ，缺省为normal。 [Qw_A] display garp statistics [ interface interface-list ] 显示GARP统计信息息 [Qw_A] display garp timer [ interface interface-list ] 显示GARP定时器的值 [Qw_A] display gvrp statistics [ interface interface-list ] 显示GVRP统计信息 [Qw_A] display gvrp status 显示GVRP的全局状态信息 [Qw_A] display gvrp statusreset garp statistics [ interface interface-list ] 清除GARP统计 11、DLDP配置[Qw_A] interface gigabitethernet 1&#x2F;1&#x2F;1 [Qw_A-GigabitEthernet1&#x2F;1&#x2F;1] duplex full 配置端口工作在强制全双工模式 [Qw_A-GigabitEthernet1&#x2F;1&#x2F;1] speed 1000 速率为1000Mbits&#x2F;s [Qw_A] dldp enable 全局开启DLDP。 [Qw_A] dldp interval 15 设置发送DLDP报文的时间间隔为15秒。 [Qw_A] dldp work-mode &#123; enhance | normal &#125; 配置DLDP协议的工作模式为加强模式。 缺省为normal。 [Qw_A] dldp unidirectional-shutdown &#123; auto | manual &#125; 配置DLDP单向链路操作模式为自动模式。 缺省为auto [Qw_A] display dldp 1 查看DLDP状态。 ① 当光纤交叉连接时，可能有两个或三个端口处于Disable状态，剩余端口处于Inactive状态。② 当光纤一端连接正确，一端未连接时： 如果DLDP的工作模式为normal，则有收光的一端处于Advertisement状态，没有收光的一端处于Inactive状态。如果DLDP的工作模式为enhance，则有收光的一端处于Disable状态，没有收光的一端处于Inactive状态。③ dldp reset命令在全局下可以重置所有端口的DLDP状态，在接口下可以充值该端口的DLDP状态 12、端口隔离配置① 通过端口隔离特性，用户可以将需要进行控制的端口加入到一个隔离组中，实现隔离组中的端口之间二层、三层数据的隔离，既增强了网络的安全性，也为用户提供了灵活的组网方案。 [Sysname] interface ethernet1&#x2F;0&#x2F;2 将以太网端口Ethernet1&#x2F;0&#x2F;2加入隔离组。 [Sysname-Ethernet1&#x2F;0&#x2F;2] port isolate [Sysname] display isolate port 显示隔离组中的端口信息 ② 配置隔离组后，只有隔离组内各个端口之间的报文不能互通，隔离组内端口与隔离组外端口以及隔离组外端口之间的通信不会受到影响。③ 端口隔离特性与以太网端口所属的VLAN无关。④ 当汇聚组中的某个端口加入或离开隔离组后，本设备中同一汇聚组内的其它端口，均会自动加入或离开该隔离组。⑤ 对于既处于某个聚合组又处于某个隔离组的一组端口，其中的一个端口离开聚合组时不会影响其他端口，即其他端口仍将处于原聚合组和原隔离组中。⑥ 如果某个聚合组中的端口同时属于某个隔离组，当在系统视图下直接删除该聚合组后，该聚合组中的端口仍将处于该隔离组中。⑦ 当隔离组中的某个端口加入聚合组时，该聚合组中的所有端口，会自动加入隔离组中。 13、端口安全配置[Switch] port-security enable 启动端口安全功能 [Switch] interface Ethernet 1&#x2F;0&#x2F;1 进入以太网Ethernet1&#x2F;0&#x2F;1端口视图 [Switch-Ethernet1&#x2F;0&#x2F;1] port-security max-mac-count 80 设置端口允许接入的最大MAC地址数为80 [Switch-Ethernet1&#x2F;0&#x2F;1] port-security port-mode autolearn 配置端口的安全模式为autolearn [Switch-Ethernet1&#x2F;0&#x2F;1] mac-address security 0001-0002-0003 vlan 1 将Host 的MAC地址0001-0002-0003作为Security MAC添加到VLAN 1中 [Switch-Ethernet1&#x2F;0&#x2F;1] port-security intrusion-mode disableport-temporarily 设置Intrusion Protection特性被触发后，暂时关闭该端口 [Switch]port-security timer disableport 30 关闭时间为30秒。 14、端口绑定配置通过端口绑定特性，网络管理员可以将用户的MAC地址和IP地址绑定到指定的端口上。进行绑定操作后，交换机只对从该端口收到的指定MAC地址和IP地址的用户发出的报文进行转发，提高了系统的安全性，增强了对网络安全的监控。 [Qw_A-Ethernet1&#x2F;0&#x2F;1] am user-bind mac-addr 0001-0002-0003 ip-addr 10.12.1.1 将Host 1的MAC地址和IP地址绑定到Ethernet1&#x2F;0&#x2F;1 端口。 有的交换机上绑定的配置不一样 [Qw_A] interface ethernet 1&#x2F;0&#x2F;2 [Qw_A-Ethernet1&#x2F;0&#x2F;2] user-bind ip-address 192.168.0.3 mac-address 0001-0203-0405 端口过滤配置 [Qw_A] interface ethernet1&#x2F;0&#x2F;1 配置端口Ethernet1&#x2F;0&#x2F;1的端口过滤功能。 [Qw_A-Ethernet1&#x2F;0&#x2F;1] ip check source ip-address mac-address [Qw_A] dhcp-snooping 开启DHCP Snooping功能。 [Qw_A] interface ethernet1&#x2F;0&#x2F;2 设置与DHCP服务器相连的端口Ethernet1&#x2F;0&#x2F;2为信任端口。 [Qw_A-Ethernet1&#x2F;0&#x2F;2] dhcp-snooping trust 在端口Ethernet1&#x2F;0&#x2F;1上启用IP过滤功能，防止客户端使用伪造的不同源IP地址对服务器进行攻击 15、BFD配置Qw_A、Qw_B、Qw_C相互可达，在Qw_A上配置静态路由可以到达Qw_C，并使能BFD检测功能。① 在Qw_A上配置静态路由，并使能BFD检测功能，通过BFD echo报文方式实现BFD功能。 &lt;Qw_A&gt; system-view [Qw_A] bfd echo-source-ip 123.1.1.1 [Qw_A] interface vlan-interface 10 [Qw_A-vlan-interface10] bfd min-echo-receive-interval 300 [Qw_A-vlan-interface10] bfd detect-multiplier 7 [Qw_A-vlan-interface10] quit [Qw_A] ip route-static 120.1.1.1 24 10.1.1.100 bfd echo-packet ② 在Qw_A上打开BFD功能调试信息开关。 &lt;Qw_A&gt; debugging bfd event &lt;Qw_A&gt; debugging bfd scm &lt;Qw_A&gt; terminal debugging ③ 在Qw_A上可以打开BFD功能调试信息开关，断开Hub和Qw_B之间的链路，验证配置结果。验证结果显示， ④ Qw_A能够快速感知Qw_A与Qw_B之间链路的变化。 16、QinQ配置Provider A、Provider B之间通过Trunk端口连接，Provider A属于运营商网络的VLAN1000，Provider B属于运营商网络的VLAN2000。Provider A和Provider B之间，运营商采用其他厂商的设备，TPID值为0x8200。希望配置完成后达到下列要求： Customer A的VLAN10的报文可以和Customer B的VLAN10的报文经过运营商网络的VLAN1000转发后互通；Customer A的VLAN20的报文可以 和Customer C的VLAN20的报文经过运营商网络的VLAN2000转发后互通。","categories":[{"name":"网络","slug":"网络","permalink":"http://zhou39716.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"network","slug":"network","permalink":"http://zhou39716.github.io/tags/network/"}],"author":"ben"},{"title":"ACL命令相关知识","slug":"ACL相关","date":"2020-01-09T08:44:00.000Z","updated":"2021-05-10T09:45:17.841Z","comments":true,"path":"ACL相关/","link":"","permalink":"http://zhou39716.github.io/ACL%E7%9B%B8%E5%85%B3/","excerpt":"","text":"———————————————— ACL相关一、什么是ACL访问控制列表 应用于路由器接口的指令列表，用于指定哪些数据包可以接收转发，哪些数据包需要拒绝，涉及到两个动作：permit（允许）deny（拒绝） permit（允许）：数据包过滤，允许那些流量通过 deny（拒绝）：数据包过滤，拒绝那些流量通过 二、ACL的工作原理读取第三层及第四层包头中的信息 根据预先定义好的规则对包进行过滤 三、ACL的作用1.提供网络的基本安全（限制某些业务网段或设备的互访，也可以隔离有病毒隐患的设备或者主机等） 2.QOS可以对数据流量进行控制，提高我们的服务质量 3.NAT 允许某些特定的网络可以去上因特网 四、ACL的组成ACL由若干条permit或deny语句组成。每条语句就是该ACL的一条规则，每条语句中的permit或deny就是与这条规则相对应的处理动作。原本华为和思科的ACL都是默认拒绝一切，但是，华为模拟器默认是允许一切。 ACL的组成： ACL编号：在网络设备上配置ACL时，每个ACL都需要分配一个编号，称为ACL编号，用来标识ACL。 规则：一个ACL通常由若干条“permit/deny”语句组成，每条语句就是该ACL的一条规则。 规则编号：每条规则都有一个相应的编号，称为规则编号，用来标识ACL规则。可以自定义，也可以系统自动分配。 动作：每条规则中的permit或deny，就是与这条规则相对应的处理动作。permit指“允许”，deny指“拒绝”， 匹配项：ACL定义了极其丰富的匹配项。例子中体现的源地址，ACL还支持很多其他规则匹配项。 五、规则编号规则编号（Rule ID）： 一个ACL中的每一条规则都有一个相应的编号。 步长（Step）: 步长是系统自动为ACL规则分配编号时，每个相邻规则编号之间的差值，缺省值为5。步长的作用是为了方便后续在旧规则之间，插入新的规则。 Rule ID分配规则： 系统为ACL中首条未手工指定编号的规则分配编号时，使用步长值（例如步长=5，首条规则编号为5）作为该规则的起始编号；为后续规则分配编号时，则使用大于当前ACL内最大规则编号且是步长整数倍的最小整数作为规则编号。那步长的作用是什么？直接rule 1/2/3/4…为什么不可以？ 先来看一个小题目：如果希望增加一条规则，该如何处理？ 可以在rule 10和rule 15之间，手工加入一条rule 11。 因此，设置一定长度的步长的作用，是方便后续在旧规则之间插入新的规则。 六、通配符通配符 (Wildcard) 通配符是一个32比特长度的数值，用于指示IP地址中，哪些比特位需要严格匹配，哪些比特位无需匹配。 通配符通常采用类似网络掩码的点分十进制形式表示，但是含义却与网络掩码完全不同。当进行IP地址匹配的时候，后面会跟着32位掩码位，这32位称为通配符。 通配符，也是点分十进制格式，换算成二进制后，“0”表示“匹配”，“1”表示“不关心”。 具体看下这2条规则： rule 5: 拒绝源IP地址为10.1.1.1报文通过——因为通配符为全0，所以每一位都要严格匹配，因此匹配的是主机IP地址10.1.1.1； rule 15:允许源IP地址为10.1.1.0/24网段地址的报文通过——因为通配符：0.0.0.11111111，后8位为1，表示不关心，因此10.1.1.xxxxxxxx 的后8位可以为任意值，所以匹配的是10.1.1.0/24网段。 七、ACL的分类与标识基于ACL规则定义方式的分类 分类 编号范围 规则定义描述 基本ACL 2000~2999 仅使用报文的源IP地址、分片信息和生效时间段信息来定义规则。 高级ACL 3000~3999 可使用IPv4报文的源IP地址、目的IP地址、IP协议类型、ICMP类型、TCP源/目的端口号、UDP源/目的端口号、生效时间段等来定义规则。 二层ACL 4000~4999 使用报文的以太网帧头信息来定义规则，如根据源MAC地址、目的MAC地址、二层协议类型等。 用户自定义ACL 5000~5999 使用报文头、偏移位置、字符串掩码和用户自定义字符串来定义规则。 用户ACL 6000~6999 既可使用IPv4报文的源IP地址或源UCL（User Control List）组，也可使用目的IP地址或目的UCL组、IP协议类型、ICMP类型、TCP源端口/目的端口、UDP源端口/目的端口号等来定义规则。 基于ACL标识方法的分类 分类 规则定义描述 数字型ACL 传统的ACL标识方法。创建ACL时，指定一个唯一的数字标识该ACL。 命名型ACL 通过名称代替编号来标识ACL。 八、基本ACL&amp;高级ACL基本ACL： 主要针对IP报文的源IP地址进行匹配，基本ACL的编号范围是2000-2999。 比如这个例子，创建的是acl 2000，就意味着创建的是基本ACL。高级ACL：可以根据IP报文中的源IP地址、目的IP地址、协议类型，TCP或UDP的源目端口号等元素进行匹配，可以理解为：基本ACL是高级ACL的一个子集，高级ACL可以比基本ACL定义出更精确、更复杂、更灵活的规则。 九、ACL的匹配机制ACL的匹配机制概括来说就是： 配置ACL的设备接收报文后，会将该报文与ACL中的规则逐条进行匹配，如果不能匹配上，就会继续尝试去匹配下一条规则。 一旦匹配上，则设备会对该报文执行这条规则中定义的处理动作，并且不再继续尝试与后续规则匹配。 匹配流程：首先系统会查找设备上是否配置了ACL。 如果ACL不存在，则返回ACL匹配结果为：不匹配。 如果ACL存在，则查找设备是否配置了ACL规则。 如果规则不存在，则返回ACL匹配结果为：不匹配。 如果规则存在，则系统会从ACL中编号最小的规则开始查找。 如果匹配上了permit规则，则停止查找规则，并返回ACL匹配结果为：匹配（允许）。 如果匹配上了deny规则，则停止查找规则，并返回ACL匹配结果为：匹配（拒绝）。 如果未匹配上规则，则继续查找下一条规则，以此循环。如果一直查到最后一条规则，报文仍未匹配上，则返回ACL匹配结果为：不匹配。 从整个ACL匹配流程可以看出，报文与ACL规则匹配后，会产生两种匹配结果：“匹配”和“不匹配”。 匹配（命中规则）：指存在ACL，且在ACL中查找到了符合匹配条件的规则。不论匹配的动作是“permit”还是“deny”，都称为“匹配”，而不是只是匹配上permit规则才算“匹配”。 不匹配（未命中规则）：指不存在ACL，或ACL中无规则，再或者在ACL中遍历了所有规则都没有找到符合匹配条件的规则。以上三种情况，都叫做“不匹配”。 匹配原则：一旦命中即停止匹配。 ACL的匹配顺序及匹配结果 配置顺序（config模式） 系统按照ACL规则编号从小到大的顺序进行报文匹配，规则编号越小越容易被匹配。 十、入站 (Inbound)及出站 (Outbound)方向 十一、ACL的基础配置基本ACL的基础配置命令 创建基本ACL [Huawei] acl [ number ] acl-number [ match-order config ] 使用编号（2000～2999）创建一个数字型的基本ACL，并进入基本ACL视图。 [Huawei] acl name acl-name &#123; basic | acl-number &#125; [ match-order config ] 使用名称创建一个命名型的基本ACL，并进入基本ACL视图。 配置基本ACL的规则 [Huawei-acl-basic-2000] rule [ rule-id ] &#123; deny | permit &#125; [ source &#123;source-address source-wildcard | any &#125; | time-range time-name ] 在基本ACL视图下，通过此命令来配置基本ACL的规则。 高级ACL的基础配置命令 创建高级ACL [Huawei] acl [ number ] acl-number [ match-order config ] 使用编号（3000～3999）创建一个数字型的高级ACL，并进入高级ACL视图。 [Huawei] acl name acl-name &#123; advance | acl-number &#125; [ match-orderconfig ] 使用名称创建一个命名型的高级ACL，进入高级ACL视图。 配置基本ACL的规则 根据IP承载的协议类型不同，在设备上配置不同的高级ACL规则。对于不同的协议类型，有不同的参数组合。 当参数protocol为IP时，高级ACL的命令格式为 rule [ rule-id ] &#123; deny | permit &#125; ip [ destination &#123;destination-address destination-wildcard | any &#125; | source &#123; source-address source-wildcard | any &#125; | time-range time-name | [ dscp dscp | [ tos tos |precedence precedence ] ] ] 在高级ACL视图下，通过此命令来配置高级ACL的规则。 当参数protocol为TCP时，高级ACL的命令格式为 rule [ rule-id ] &#123; deny | permit &#125; &#123; protocol-number | tcp &#125; [destination &#123; destination-address destination-wildcard | any &#125; | destination-port &#123; eq port | gt port | lt port | range port-start port-end &#125; |source &#123; source-address source-wildcard | any &#125; | source-port &#123; eq port | gt port | lt port | range port-start port-end &#125; | tcp-flag &#123; ack | fin | syn &#125; * |time-range time-name ] * 在高级ACL视图下，通过此命令来配置高级ACL的规则。","categories":[{"name":"网络","slug":"网络","permalink":"http://zhou39716.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"网络","slug":"网络","permalink":"http://zhou39716.github.io/tags/%E7%BD%91%E7%BB%9C/"}],"author":"ben"}],"categories":[{"name":"网络","slug":"网络","permalink":"http://zhou39716.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"network","slug":"network","permalink":"http://zhou39716.github.io/tags/network/"},{"name":"pc","slug":"pc","permalink":"http://zhou39716.github.io/tags/pc/"},{"name":"网络","slug":"网络","permalink":"http://zhou39716.github.io/tags/%E7%BD%91%E7%BB%9C/"}]}